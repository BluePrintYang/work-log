(window.webpackJsonp=window.webpackJsonp||[]).push([[319],{722:function(t,r,e){"use strict";e.r(r);var a=e(56),i=Object(a.a)({},(function(){var t=this,r=t.$createElement,e=t._self._c||r;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h2",{attrs:{id:"log"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#log"}},[t._v("#")]),t._v(" log")]),t._v(" "),e("h3",{attrs:{id:"融云消息id生成策略"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#融云消息id生成策略"}},[t._v("#")]),t._v(" "),e("a",{attrs:{href:"http://www.52im.net/thread-2747-1-1.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("融云消息ID生成策略"),e("OutboundLink")],1)]),t._v(" "),e("blockquote",[e("p",[t._v("融云消息数据的唯一 ID 长度采用 80 Bit")])]),t._v(" "),e("p",[t._v("每 5 个 Bit ，进行一次 32 进制编码，转换为一个字符。80 Bit 可以转换为 16 个字符，再加上 3 个分隔符（ - ），将 16 个字符分为 4 组，最终得到一个 19 字符的唯一 ID ，形如："),e("em",[e("code",[t._v("BD8U-FCOJ-LDC5-L789")])])]),t._v(" "),e("p",[t._v("80 Bit 被分为 4 段")]),t._v(" "),e("ol",[e("li",[t._v("**第一段 42 Bit：**用于存放时间戳，最长可表示到 2109 年")]),t._v(" "),e("li",[t._v("**第二段 12 Bit：**用于存放自旋转 ID 。自旋 ID 就是在给落到同一毫秒内的消息进行自增编号。12 Bit 则意味着，同一毫秒内，单台主机中最多可以标识 4096（ 2 的 12 次方）条消息。")]),t._v(" "),e("li",[t._v("**第三段 4   Bit：**用于标识会话类型。4 Bit ，最多可以标识 16 种会话。")]),t._v(" "),e("li",[t._v("**第四段 22 Bit：**会话 ID 。如群聊中的群 ID ，聊天室中的聊天室 ID 等。")])]),t._v(" "),e("h3",{attrs:{id:"美团leaf-segment"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#美团leaf-segment"}},[t._v("#")]),t._v(" "),e("a",{attrs:{href:"http://www.52im.net/thread-2751-1-1.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("美团Leaf-Segment"),e("OutboundLink")],1)]),t._v(" "),e("h4",{attrs:{id:"基本原理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#基本原理"}},[t._v("#")]),t._v(" 基本原理")]),t._v(" "),e("p",[e("strong",[t._v("数据库表设计如下：")])]),t._v(" "),e("h4",{attrs:{id:"双buffer优化"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#双buffer优化"}},[t._v("#")]),t._v(" 双buffer优化")]),t._v(" "),e("h3",{attrs:{id:"百度uidgenerator"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#百度uidgenerator"}},[t._v("#")]),t._v(" "),e("a",{attrs:{href:"https://github.com/baidu/uid-generator",target:"_blank",rel:"noopener noreferrer"}},[t._v("百度"),e("strong",[t._v("UidGenerator")]),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("改进后的SnowFlake算法")]),t._v(" "),e("p",[e("strong",[t._v("原版SnowFlake算法各字段的具体意义是：")])]),t._v(" "),e("ol",[e("li",[t._v("1位sign标识位；")]),t._v(" "),e("li",[t._v("41位时间戳；")]),t._v(" "),e("li",[t._v("10位workId（即5位数据中心id+5位工作机器id）；")]),t._v(" "),e("li",[t._v("12位自增序列。")])]),t._v(" "),e("p",[e("strong",[t._v("UidGenerator默认ID中各数据位的含义如下：")])]),t._v(" "),e("ol",[e("li",[t._v("*sign(1bit)：*固定1bit符号标识，即生成的UID为正数。")]),t._v(" "),e("li",[t._v('*delta seconds (28 bits)：*当前时间，相对于时间基点"2016-05-20"的增量值，单位：秒，最多可支持约8.7年（注意：(a)这里的单位是秒，而不是毫秒！ (b)注意这里的用词，是“最多”可支持8.7年，为什么是“最多”，后面会讲）。')]),t._v(" "),e("li",[t._v("*worker id (22 bits)：*机器id，最多可支持约420w次机器启动。内置实现为在启动时由数据库分配，默认分配策略为用后即弃，后续可提供复用策略。")]),t._v(" "),e("li",[t._v("*sequence (13 bits)：*每秒下的并发序列，13 bits可支持每秒8192个并发（注意下这个地方，默认支持qps最大为8192个）")])]),t._v(" "),e("h3",{attrs:{id:"tinyid"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#tinyid"}},[t._v("#")]),t._v(" "),e("a",{attrs:{href:"http://www.52im.net/thread-3129-1-1.html",target:"_blank",rel:"noopener noreferrer"}},[e("strong",[t._v("Tinyid")]),e("OutboundLink")],1)]),t._v(" "),e("h2",{attrs:{id:"learn"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#learn"}},[t._v("#")]),t._v(" learn")]),t._v(" "),e("h3",{attrs:{id:"每日一题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#每日一题"}},[t._v("#")]),t._v(" 每日一题")])])}),[],!1,null,null,null);r.default=i.exports}}]);